var DeviceConfiguration=function(){var F=Date.now(),m="browser",G=function(){var b=!1;try{b="jid"in Conversations.getCurrentConversation()}catch(a){b=!1}return"projector"!=m&&b},h={tools:!1,slides:!1,header:!1,keyboard:!1,footer:!1},e=function(b,a){G&&("header"==b||1!=a&&0!=a||(h[b]=a))},y=function(){m=null!=navigator.userAgent.match(/iPhone/i)||null!=navigator.userAgent.match(/iPod/i)?"iPhone":null!=navigator.userAgent.match(/iPad/i)?"iPad":null!=navigator.userAgent.match("Trident/7.0")?"IE11+":
"browser"},q=function(){y();$("#absoluteCloseButton").removeClass("closeButton").text("").click(bounceAnd(function(){}));$("#applicationMenuButton").show();k=z;try{"Conversations"in window&&"jid"in Conversations.getCurrentConversation()&&("UserSettings"in window&&UserSettings.getIsInteractive()?(DeviceConfiguration.setHeader(!0),DeviceConfiguration.setTools(!0),DeviceConfiguration.setSlides(!0),DeviceConfiguration.setFooter(!0)):(DeviceConfiguration.setHeader(!1),DeviceConfiguration.setTools(!1),
DeviceConfiguration.setSlides(!1),DeviceConfiguration.setFooter(!1)))}catch(b){console.log("error while trying to fix the layout:",b)}zoomToPage(!0);k()},I=function(){Conversations.enableSyncMove();UserSettings.setIsInteractive(!1);m="projector";e("tools",!1);e("slides",!1);e("header",!1);e("footer",!1);k=H;zoomToFit(!0);$("#absoluteCloseButton").addClass("closeButton").text("X").click(bounceAnd(function(){UserSettings.setIsInteractive(!0);q()}));$("#applicationMenuButton").hide();Modes.none.activate();
k()},D=function(){var b=screen.width,a=screen.height,d;"orientation"in window?(d=window.orientation,d=90==d||-90==d):d=window.innerWidth>window.innerHeight;"landscape"==(d?"landscape":"portrait")&&b<a&&(b=screen.height,a=screen.width);d=window.innerWidth;var c=window.innerHeight;if(!d||!c||d>b||c>a||980==d)d=window.outerWidth,c=window.outerHeight;if(!d||!c||d>b||c>a)d=screen.availWidth,c=screen.availHeight;return{width:d,height:c}},z=function(){E(h.header,h.tools,h.slides,h.keyboard)},k=z,H=function(){E(!1,
!1,!1,!1)},f=function(b){b=parseInt(b.split("px")[0]);return isNaN(b)?0:b},x=function(b){return{x:_.sum(_.map(b,function(a){var b=f(a.css("margin-left"))+f(a.css("padding-left"))+f(a.css("border"));a=f(a.css("margin-right"))+f(a.css("padding-right"))+f(a.css("border"));return b+a})),y:_.sum(_.map(b,function(a){var b=f(a.css("margin-top"))+f(a.css("padding-top"))+f(a.css("border"));a=f(a.css("margin-bottom"))+f(a.css("padding-bottom"))+f(a.css("border"));return b+a}))}},A={},c=function(b){if(!(b in
A)){var a=$(b);a&&a.length&&(A[b]=a);return a}return A[b]},E=function(b,a,d,e){if("undefined"!=typeof boardContext){var f=h.header,l=h.tools,k=h.slides;b=h.keyboard;var m=h.footer;a=c("#toolsColumn");var t=c("#ribbon").find(".toolbar"),n=c(".modeSpecificTool"),q=c("#masterLayout"),p=c("#applicationMenu");c("#boardContainer");d=c("#boardColumn");e=c("#thumbsColumn");c("#slideContainer");c("#thumbScrollContainer");var g=$(".thumbnail"),u=c("#slideControls"),v=c("#masterFooter"),w=D(),r=w.width,w=w.height;
1==f?p.show():p.hide();1==l?(t.show(),n.show(),a.show()):(n.hide(),t.hide(),a.hide());Modes.currentMode==Modes.select&&Modes.select.updateAdministerContentVisualState(Conversations.getCurrentConversation());1==k?(e.show(),u.show()):(e.hide(),u.hide());1==m?v.show():v.hide();p=c("#boardContainer");f=c("#board");m=c("#masterHeader");t=m.height();n=v.height();DeviceConfiguration.headerHeight=t;DeviceConfiguration.footerHeight=n;g.attr("width",sprintf("%spx",c("#thumbColumnWidth").val()));g.attr("height",
sprintf("%spx",k?DeviceConfiguration.preferredSizes.thumbColumn.height:0));p.width();g=p.height();q=q.css("flex-direction");"row"==q?(l=r-(l?a.width():0)-(k?e.width():0)-x([a,e,d]).x-2,g=w-t-n-x([m,v,d]).y):(l=c("#masterLayout").width()-x([d]).x,g-=10,b&&(g=g-l+3*(DeviceConfiguration.preferredSizes.handles+2)));if(0>g||0>l)throw{message:"retrying because of negativeValues",bheight:g,bwidth:l,width:r,height:w,marginsForBoard:x([d]),flexDirection:q};l=Math.round(l);g=Math.round(g);c("#selectionAdorner");
c("#radar");c("#marquee");c("#textAdorner");c("#imageAdorner");v.width(r-e.width()-a.width()-20).css({"margin-left":sprintf("%spx",a.width()+9)});f.width(l);f.height(g);a.height(g-t);e.height(g-t);d.height(g);boardContext.canvas.width=l;boardContext.canvas.height=g;boardContext.width=l;boardContext.height=g;boardWidth=l;boardHeight=g;IncludeView["default"]();blit();window.scrollTo(1,1);window.scrollTo(0,0)}},n=function(){k&&k()},B=!1;Progress.onLayoutUpdated.DeviceConfiguration=n;Progress.historyReceived.DeviceConfiguration_showChrome=
function(){try{"UserSettings"in window&&UserSettings.getIsInteractive()?(DeviceConfiguration.setSlides(!0),DeviceConfiguration.setTools(!0),!B&&"Modes"in window&&(Modes.select.activate(),"iPad"==DeviceConfiguration.getCurrentDevice()&&$("#panMode").remove())):(DeviceConfiguration.setSlides(!1),DeviceConfiguration.setTools(!1),B||Modes.none.activate()),B=!0}catch(b){console.log("Progress.historyReceived.DeviceConfiguration_showChrome",b)}y();C();n()};$(function(){var b=$(window);if(window.orientation)b.on("orientationchange",
n);b.resize(n);$("#toolsToggleButton").on("click",bounceAnd(function(){e("tools",!h.tools);var a=$("#slidesToggleButton");h.slides?a.removeClass("disabledButton"):a.addClass("disabledButton");n()}));$("#slidesToggleButton").on("click",bounceAnd(function(){e("slides",!h.slides);var a=$("#toolsToggleButton");h.tools?a.removeClass("disabledButton"):a.addClass("disabledButton");n()}));$("#thumbColumnWidth").val(DeviceConfiguration.preferredSizes.thumbColumn.width).on("input change",function(){var a=c("#thumbColumnWidth").val();
$(".thumbnail:not(.groupSlide)").width(a).height(.75*a);k();Conversations.refreshSlideDisplay()})});var C=function(){switch(m){case "browser":q();break;case "projector":void 0!=ContentFilter&&"setFilter"in ContentFilter&&ContentFilter.setFilter("myPrivate",!1);I();break;case "iPhone":q();break;case "iPad":q();break;default:q()}},u=function(){k||(k=z)},r=function(b){return function(){e(b,!h[b]);u()}},p=function(b){return function(a){e(b,a);u()}};return{getCurrentDevice:function(){return m},setCurrentDevice:function(b){m=
b;C()},applyFit:function(){u();k()},tempFit:function(b,a,c,f){e("header",b);e("tools",a);e("slides",c);e("footer",f);u();k()},setHeader:p("header"),setTools:p("tools"),setFooter:p("footer"),setSlides:p("slides"),setKeyboard:function(b){var a=!b;p("keyboard")(b);DeviceConfiguration.applyFit();$("#masterHeader").toggle(a);$(".permission-states").toggle(a);$("#majorModesColumn").toggle(a)},toggleHeader:r("header"),toggleTools:r("tools"),toggleFooter:r("footer"),toggleSlides:r("slides"),getIdentity:function(){return F},
resetCurrentDevice:function(){y();C()},hasOnScreenKeyboard:function(){return 640>=D().width||"iPad"==m},preferredSizes:{handles:50,thumbColumn:{width:100,height:75},toolsColumn:100,keyboard:{iphone:236,ipad:352}}}}();
