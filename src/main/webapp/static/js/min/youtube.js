(function(){window.YoutubeVideo=function(c,a){return $.ajax({url:"http://www.youtube.com/get_video_info?video_id="+c,dataType:"text"}).done(function(b){b=YoutubeVideo.decodeQueryString(b);if("fail"===b.status)return a(b);b.sources=YoutubeVideo.decodeStreamMap(b.url_encoded_fmt_stream_map);b.getSource=function(a,b){var c,g,h,k,l;c=h=null;l=this.sources;for(g in l)k=l[g],k.type.match(a)&&(k.quality.match(b)?c=k:h=k);return c||h};return a(b)})};window.YoutubeVideo.decodeQueryString=function(c){var a,
b,d,e,f;d={};b=c.split("&");e=0;for(f=b.length;e<f;e++)a=b[e],c=decodeURIComponent(a.split("=")[0]),a=decodeURIComponent(a.split("=")[1]||""),d[c]=a;return d};window.YoutubeVideo.decodeStreamMap=function(c){var a,b,d,e,f,g;b={};g=c.split(",");c=0;for(f=g.length;c<f;c++)a=g[c],d=YoutubeVideo.decodeQueryString(a),e=d.type.split(";")[0],a=d.quality.split(",")[0],d.original_url=d.url,d.url=""+d.url+"&signature="+d.sig,b[""+e+" "+a]=d;return b}}).call(this);
var renderVideoByUrlToCanvas=function(c,a,b,d,e,f){renderVideoToCanvas(function(a){a.attr("src",c)},a,b,d,e,f)},renderVideoFromWebcamToCanvas=function(c,a,b,d,e){renderVideoToCanvas(function(a){navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(function(b){a.srcObject=b})["catch"](function(a){console.log("couldn't get stream",a)})},c,a,b,d,e)},renderVideoToCanvas=function(c,a,b,d,e,f){var g=a.getContext("2d");a=$("<video/>");var h=function(a,b,c,d,e){if(a.paused||a.ended)return!1;g.drawImage(a,
b,c,d,e);requestAnimationFrame(function(){h(a,b,c,d,e)})};a[0].addEventListener("play",function(){h(this,b,d,e,f)},!1);c(a);a[0].play()};
